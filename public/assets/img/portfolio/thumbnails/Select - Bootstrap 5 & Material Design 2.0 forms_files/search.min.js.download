function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Search=function(){"use strict";function e(t,n,r,a,i,o){_classCallCheck(this,e),this.input=t,this.list=r,this.icon=n,this.form=a,this.dropdown=i,this.count=o,this.data=[],this.searchValue="",this.keycodes=Object.freeze({ARROW_UP:38,ARROW_DOWN:40,ENTER:13,SLASH:191,ESCAPE:27})}return _createClass(e,[{key:"init",value:function(){var e=this;fetch("/wp-content/themes/mdbootstrap4/js/search/search.json").then(function(e){return e.json()}).then(function(t){e.data=_toConsumableArray(t),new PerfectScrollbar(e.list),e.bindEvents()})}},{key:"bindEvents",value:function(){var e=this;this.input.addEventListener("input",function(t){return e.search(t)}),this.input.addEventListener("focus",function(t){e.icon.classList.add("text-primary"),t.target.value.length>0&&e.search(t)}),this.input.addEventListener("blur",function(){e.icon.classList.remove("text-primary")}),this.input.addEventListener("keydown",function(t){t.keyCode===e.keycodes.ARROW_DOWN&&e.options.length>0&&(t.preventDefault(),e.options[0].focus())}),window.addEventListener("click",function(t){e.visibleDropdown&&e.isOutside(t.target)&&e.toggleDropdown(!1)}),window.addEventListener("keydown",function(t){t.keyCode===e.keycodes.SLASH&&t.ctrlKey&&t.target!==e.input?(t.preventDefault(),e.input.focus()):t.keyCode===e.keycodes.ESCAPE&&e.visibleDropdown&&e.toggleDropdown(!1)})}},{key:"search",value:function(e){this.searchValue=this.normalizeString(this.getSearchValue(e.target.value)),this.toggleDropdown(this.searchValue.length>0),this.renderResults(this.getResultsMarkup()),this.setupKeyboardNavigation()}},{key:"normalizeString",value:function(e){return e.trim().toLowerCase()}},{key:"getSearchValue",value:function(e){return e.length>1&&"/"===e[0]?e.slice(1):e}},{key:"toggleDropdown",value:function(e){var t=e?"block":"none";this.dropdown.style.display=t}},{key:"renderResults",value:function(e){this.list.innerHTML=e,this.count.innerHTML=this.results.length}},{key:"getResultsMarkup",value:function(){var e=this;return this.results.map(function(t,n){var r=t.keywords.filter(function(t){return e.searchValue.length>0&&t.match(e.searchValue)});return'\n      <li>\n        <a class="pt-2 px-2 text-muted d-block" href="'.concat(t.href,'">\n          <p class="text-uppercase mb-0">').concat(e.highlightSearch(t.name,e.searchValue),'</p>\n          <p class="small font-weight-bold mb-0 pb-2">').concat(e.highlightSearch(t.category,e.searchValue),"</p>\n          ").concat(r.length>0?'<p class="small mb-0 pb-2 mdb-5-search-keywords">'.concat(e.formatKeywords(r),"</p>"):"","\n        </a>\n        ").concat(n!==e.results.length-1?'<hr class="m-0 p-0">':"","\n      </li>\n    ")}).join("\n")}},{key:"compare",value:function(e){var t=this,n=e.name,r=e.keywords,a=e.category;return"/"===this.searchValue||this.normalizeString(n).match(this.searchValue)||this.normalizeString(a).match(this.searchValue)||r.find(function(e){return e.match(t.searchValue)})}},{key:"highlightSearch",value:function(e){var t=this.normalizeString(e).indexOf(this.searchValue);return-1===t?e:"".concat(e.slice(0,t),'<u class="text-primary">').concat(e.slice(t,t+this.searchValue.length),"</u>").concat(e.slice(t+this.searchValue.length))}},{key:"formatKeywords",value:function(e){var t=this;return e.map(function(e){return t.highlightSearch(e)}).join(", ")}},{key:"setupKeyboardNavigation",value:function(){var e=this;this.options.forEach(function(t,n){t.addEventListener("keydown",function(t){return e.focusNextOption(t,n)})})}},{key:"focusNextOption",value:function(e,t){var n;if(e.keyCode===this.keycodes.ARROW_DOWN)n=1;else{if(e.keyCode!==this.keycodes.ARROW_UP)return;n=-1}e.preventDefault();var r=t+n>this.options.length-1?0:t+n<0?this.options.length-1:t+n;this.options[r].focus()}},{key:"isOutside",value:function(e){return e!==this.form&&(e===document.body||this.isOutside(e.parentNode))}},{key:"visibleDropdown",get:function(){return"block"===this.dropdown.style.display}},{key:"options",get:function(){return this.list.getElementsByTagName("a")}},{key:"results",get:function(){var e=this;return this.data.filter(function(t){return e.compare(t)})}}]),e}();